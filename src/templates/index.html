{% extends "base.html" %}

{% block title %}主页{% endblock %}

{%- block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"  media="all">
{% endblock -%}

{% block content %}
    <blockquote class="layui-elem-quote">
        当前位置: 主页
    </blockquote>
    <div class="container">
        <div class="waterfall" id="layImages">
        </div>
    </div>
{% endblock %}

{% block script %}
<script type="text/javascript">
layui.use(['util', 'flow'], function(){
    var $ = layui.jquery;
    var util = layui.util;
    var flow = layui.flow;
    //右下角工具
    util.fixbar();
    //流加载图片
    flow.load({
        elem: '#layImages'
        ,isLazyimg: true
        ,isAuto: true
        ,done: function(page, next){ //加载下一页
            page -= 1;
            var lis = [];
            var params = {Action: "getList", page: page, length: 10};
            $.get('{{ url_for("api_view") }}?'+make_url(params), function(res){
                console.log(res);
                layui.each(res.data, function(index, item){
                    lis.push('<div class="item"><img src="'+item.imgUrl+'"></div>');
                }); 
                next(lis.join(''), page < res.pageCount);    
            });
        }
    });
});
</script>
{% endblock %}